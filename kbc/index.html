<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>KBC KAUN BANEGA CROREPATI</title>

<!-- Fonts (system fallback if offline) -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
  /* shared base */
  :root{
    --bg: #001f3f; --panel:#012a63; --gold:#f0c45a; --muted:#9fb6d6;
    --accent: #3b3cff; --accent-2:#2d8cff;
    --glass: rgba(255,255,255,0.04);
    --text:#fff;
  }
  html,body{height:100%;margin:0;font-family:Poppins,Inter,Arial,"Helvetica Neue",sans-serif;background:linear-gradient(180deg,var(--bg),#021422);color:var(--text);-webkit-font-smoothing:antialiased}
  .wrap{max-width:1150px;margin:18px auto;padding:18px}
  .topbar{display:flex;align-items:center;gap:14px;justify-content:space-between}
  .titleRow{display:flex;align-items:center;gap:16px}
  .logoCircle{width:86px;height:86px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:900;color:#1b1040;background:linear-gradient(135deg,var(--gold),#d49e2a);box-shadow:0 8px 30px rgba(0,0,0,0.6)}
  h1{margin:0;font-size:20px}
  .sub{color:var(--muted);font-size:13px}

  /* variant controls */
  .controlsRow{display:flex;gap:8px;align-items:center}
  .variantBtn{padding:8px 12px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);cursor:pointer}
  .variantBtn.active{background:var(--gold);color:#0b1537;border-color:var(--gold);font-weight:800}

  /* game grid */
  .game{display:grid;grid-template-columns:1fr 320px;gap:18px;margin-top:18px}
  .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}

  /* START overlay */
  #startOverlay{position:fixed;inset:0;background:linear-gradient(90deg,rgba(0,0,0,0.8),rgba(0,0,0,0.6));display:flex;align-items:center;justify-content:center;z-index:9999}
  #startOverlay .sheet{background:linear-gradient(180deg,#012a63,#001f47);padding:30px;border-radius:14px;text-align:center;box-shadow:0 10px 50px rgba(0,0,0,0.7)}
  #startBtn{font-size:22px;padding:14px 28px;border-radius:10px;border:none;background:var(--gold);cursor:pointer;font-weight:800}

  /* question area common */
  .questionBox{min-height:220px;border-radius:12px;padding:18px;position:relative;overflow:hidden}
  #timer{font-size:18px;font-weight:800;color:var(--gold);text-align:center;margin-bottom:10px}
  #question-text{font-size:20px;margin:0 0 12px;text-align:center}
  .options{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}

  .option{padding:12px 12px;border-radius:10px;border:2px solid rgba(255,255,255,0.06);background:rgba(0,0,0,0.08);cursor:pointer;font-weight:700;display:flex;gap:8px;align-items:center;transition:all .18s;box-shadow:0 6px 18px rgba(0,0,0,0.35)}
  .option:hover{transform:translateY(-4px)}
  .option.disabled{opacity:0.45;pointer-events:none}
  .option.selected{border-color:var(--gold);background:rgba(240,196,90,0.12)}

  .controls{display:flex;gap:10px;align-items:center;margin-top:12px}
  .btn{background:var(--gold);color:#042039;padding:10px 14px;border-radius:8px;border:none;font-weight:800;cursor:pointer}
  .btn.secondary{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.05)}

  .lifelines{display:flex;gap:8px}
  .lifeline{background:#083a6b;padding:8px 10px;border-radius:8px;color:var(--muted);font-weight:700;border:1px solid rgba(255,255,255,0.03);cursor:pointer}

  /* ladder */
  .money{font-weight:800;color:var(--gold);text-align:center;margin-bottom:10px}
  #ladder div{padding:6px 10px;border-radius:6px;margin-bottom:6px;background:rgba(255,255,255,0.02);display:flex;justify-content:space-between;font-weight:700}
  #ladder div.active{background:linear-gradient(90deg,var(--gold),#d9b24a);color:#042039;box-shadow:0 6px 20px rgba(217,178,74,0.3)}

  /* small screens */
  @media (max-width:920px){.game{grid-template-columns:1fr;}.sidebar{order:2}.options{grid-template-columns:1fr}}

  /* ---------------------------
     VARIANT A — SONY KBC TV STYLE
     --------------------------- */
  .variant-a .questionBox{
    background: radial-gradient(circle at 20% 10%, rgba(90,50,200,0.12), transparent 20%), linear-gradient(135deg,#06103f,#0b0b2b);
    border:3px solid rgba(66,40,180,0.4);
    box-shadow:0 18px 60px rgba(80,60,200,0.22), inset 0 0 40px rgba(80,60,200,0.08);
  }
  .variant-a #question-text{font-size:22px;font-weight:800;color:#dfe7ff;text-shadow:0 4px 18px rgba(80,60,210,0.6)}
  .variant-a .option{border-radius:16px;padding:18px 16px;background:linear-gradient(90deg,#0b1a66,#0d1147);border:2px solid rgba(80,60,210,0.5);box-shadow:0 10px 30px rgba(70,60,210,0.28)}
  .variant-a .option:hover{background:linear-gradient(90deg,#1b2fff,#0d3fff);transform:translateY(-6px);box-shadow:0 20px 50px rgba(70,60,220,0.45)}
  .variant-a .option strong{width:36px;height:36px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.15);border:2px solid rgba(255,255,255,0.06);margin-right:8px}
  .variant-a .logoCircle{width:110px;height:110px;border-radius:50%;background:radial-gradient(circle,#ffd97d,#c38b1a);box-shadow:0 12px 30px rgba(255,200,90,0.25);color:#2a1650;font-size:26px}

  /* ---------------------------
     VARIANT B — MOBILE GAME STYLE
     --------------------------- */
  .variant-b .questionBox{
    background:linear-gradient(180deg,#10204a,#071033);
    border-radius:14px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 10px 30px rgba(10,10,30,0.6)
  }
  .variant-b #question-text{font-size:18px;text-align:left;padding-left:6px}
  .variant-b .options{grid-template-columns:1fr;gap:12px}
  .variant-b .option{border-radius:12px;padding:14px 12px;background:linear-gradient(180deg,#0f2855,#0b1b3a);border:1px solid rgba(255,255,255,0.03)}
  .variant-b .option:hover{transform:none;opacity:0.95}
  .variant-b .logoCircle{width:80px;height:80px;border-radius:14px;background:linear-gradient(135deg,var(--gold),#d49e2a);font-size:20px;color:#110e2e}

  /* ---------------------------
     VARIANT C — HYBRID
     --------------------------- */
  .variant-c .questionBox{
    background:linear-gradient(135deg,#11206a,#081033);border-radius:16px;border:2px solid rgba(255,255,255,0.04);box-shadow:0 14px 40px rgba(20,20,80,0.4)
  }
  .variant-c #question-text{text-align:center;font-size:20px;font-weight:700}
  .variant-c .option{border-radius:12px;padding:14px;background:linear-gradient(180deg,#141a54,#0b1236);border:2px solid rgba(80,80,200,0.08)}
  .variant-c .logoCircle{width:96px;height:96px;border-radius:20px;background:linear-gradient(135deg,var(--gold),#d49e2a);font-size:22px;color:#150f3a}

  /* feedback styles */
  .option.correct{background:linear-gradient(90deg,#8fe08f,#66c466)!important;color:#022205;border-color:#66c466}
  .option.wrong{background:linear-gradient(90deg,#f28a8a,#e64e4e)!important;color:#2b0202;border-color:#e64e4e}
</style>
</head>
<body>
  <!-- START overlay -->
  <div id="startOverlay">
    <div class="sheet">
      <h2 style="margin-top:0">Welcome to KBC — Play Now</h2>
      <p style="color:var(--muted)">Click START to begin the KBC KAUN BANEGA CROREPATI</p>
      <button id="startBtn">START</button>
    </div>
  </div>

  <div class="wrap">
    <div class="topbar">
      <div class="titleRow">
        <div class="logoCircle" id="logo">KBC</div>
        <div>
          <h1>KBC — General Knowledge</h1>
          <div class="sub">Audio, lifelines, timer — three UI variants included</div>
        </div>
      </div>

      <div class="controlsRow">
        <div style="display:flex;gap:8px;align-items:center">
          <button class="variantBtn active" data-variant="a" id="vbA">Variant A</button>
          <button class="variantBtn" data-variant="b" id="vbB">Variant B</button>
          <button class="variantBtn" data-variant="c" id="vbC">Variant C</button>
        </div>
      </div>
    </div>

    <div class="game" id="gameRoot">
      <div class="panel questionPanel">
        <div class="questionBox" id="questionBox">
          <div id="timer">Time: <span id="timeValue">30</span>s</div>
          <div id="question-text">Loading questions...</div>
          <div class="options" id="options"></div>
        </div>

        <div class="controls">
          <div class="lifelines">
            <button class="lifeline" id="btn5050">50-50</button>
            <button class="lifeline" id="btnSwitch">Switch</button>
            <button class="lifeline" id="btnAudience">Audience</button>
          </div>

          <div style="margin-left:auto;display:flex;gap:8px">
            <button class="btn secondary" id="btnLock">Lock Answer</button>
            <button class="btn" id="btnNext">Next</button>
          </div>
        </div>

        <div class="status" id="statusBar">Question <strong id="qIndex">0</strong> / <strong id="qTotal">0</strong> · Score: <strong id="score">0</strong></div>
      </div>

      <div class="panel sidebar">
        <div class="money">Money Ladder</div>
        <div id="ladder"></div>
        <div class="status center" style="margin-top:14px">
          <div style="text-align:left;width:100%">
            <div>50-50 used: <span id="used5050">No</span></div>
            <div>Switch used: <span id="usedSwitch">No</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- audio tags - if files exist in the folder they'll be used -->
  <audio id="audio-start" src="start.mp3" preload="auto"></audio>
  <audio id="audio-bg" src="bg.mp3" preload="auto" loop></audio>
  <audio id="audio-question" src="question.mp3" preload="auto"></audio>
  <audio id="audio-clock" src="clock.mp3" preload="auto" loop></audio>
  <audio id="audio-lock" src="lock.mp3" preload="auto"></audio>
  <audio id="audio-confirm" src="confirm.mp3" preload="auto"></audio>
  <audio id="audio-correct" src="correct.mp3" preload="auto"></audio>
  <audio id="audio-wrong" src="wrong.mp3" preload="auto"></audio>

<script>
/* ---- Main script: UI switching + game logic + robust audio fallback ----
   - Use the three variant classes on body: variant-a, variant-b, variant-c
   - AudioManager: tries file elements; if missing, uses WebAudio synth
*/

(function(){
  // ---- UI Variant switching ----
  const vbA = document.getElementById('vbA');
  const vbB = document.getElementById('vbB');
  const vbC = document.getElementById('vbC');
  const variantButtons = [vbA, vbB, vbC];

  function setVariant(v){
    document.body.classList.remove('variant-a','variant-b','variant-c');
    document.body.classList.add('variant-' + v);
    variantButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.variant === v));
    // small additional adjustments per-variant:
    const logo = document.getElementById('logo');
    if(v==='a'){ logo.style.width='110px'; logo.style.height='110px'; logo.style.borderRadius='50%'; }
    if(v==='b'){ logo.style.width='80px'; logo.style.height='80px'; logo.style.borderRadius='14px'; }
    if(v==='c'){ logo.style.width='96px'; logo.style.height='96px'; logo.style.borderRadius='18px'; }
  }
  vbA.addEventListener('click', ()=>setVariant('a'));
  vbB.addEventListener('click', ()=>setVariant('b'));
  vbC.addEventListener('click', ()=>setVariant('c'));
  setVariant('a'); // default

  // ---- Robust Audio Manager with fallback ----
  class AudioMgr {
    constructor(){
      this.ctx = null;
      this.sounds = {};
      // audio elements in DOM
      this.elems = {
        start: document.getElementById('audio-start'),
        bg: document.getElementById('audio-bg'),
        question: document.getElementById('audio-question'),
        clock: document.getElementById('audio-clock'),
        lock: document.getElementById('audio-lock'),
        confirm: document.getElementById('audio-confirm'),
        correct: document.getElementById('audio-correct'),
        wrong: document.getElementById('audio-wrong'),
      };
      this.bgGain = null;
      this.clockPlaying = false;
    }

    ensureCtx(){
      if(!this.ctx){
        this.ctx = new (window.AudioContext || window.webkitAudioContext)();
        this.bgGain = this.ctx.createGain();
        this.bgGain.gain.value = 0.6;
        this.bgGain.connect(this.ctx.destination);
      }
      return this.ctx;
    }

    // try to play an HTML audio element; if missing or error -> use synth
    play(name, opts={}){
      const el = this.elems[name];
      if(el && el.src){
        try{
          el.pause();
          el.currentTime = 0;
          // set loop if needed
          el.loop = !!opts.loop;
          if(name==='bg') el.volume = opts.volume ?? 0.35;
          el.play().catch(()=> {
            // if play blocked, fallback
            this._playSynth(name);
          });
          return;
        } catch(e){
          // fallback
          this._playSynth(name);
          return;
        }
      }
      // fallback to synth
      this._playSynth(name);
    }

    stop(name){
      const el = this.elems[name];
      if(el && !el.paused){
        try{ el.pause(); el.currentTime = 0; }catch(e){}
      }
      if(name==='clock') this.clockPlaying = false;
      // stop synths if any
      if(this.sounds[name] && this.sounds[name].stop){
        try{ this.sounds[name].stop(0); }catch(e){}
        delete this.sounds[name];
      }
    }

    _playSynth(name){
      const ctx = this.ensureCtx();
      // simple mapped sounds:
      if(name==='start'){ this._tone(880,0.12,0.2); return; }
      if(name==='confirm'){ this._tone(660,0.08,0.18); return; }
      if(name==='lock'){ this._tone(520,0.06,0.16); return; }
      if(name==='correct'){ this._chord([880,1320,1760],0.18); return; }
      if(name==='wrong'){ this._chord([220,165,110],0.18); return; }
      if(name==='question'){ this._tone(440,0.06,0.1); return; }
      if(name==='bg'){ this._ambient(); return; }
      if(name==='clock'){ this._clockTick(); return; }
      // default beep
      this._tone(600,0.08,0.12);
    }

    _tone(freq, dur=0.12, gain=0.15){
      const ctx = this.ensureCtx();
      const o = ctx.createOscillator();
      const g = ctx.createGain();
      o.type = 'sine';
      o.frequency.value = freq;
      g.gain.value = gain;
      o.connect(g); g.connect(ctx.destination);
      o.start();
      g.gain.setValueAtTime(g.gain.value, ctx.currentTime);
      g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + dur);
      o.stop(ctx.currentTime + dur + 0.02);
    }

    _chord(freqs, dur=0.18){
      const ctx = this.ensureCtx();
      const now = ctx.currentTime;
      freqs.forEach(f=>{
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type='sine'; o.frequency.value = f;
        g.gain.value = 0.08;
        o.connect(g); g.connect(ctx.destination);
        o.start(now);
        g.gain.exponentialRampToValueAtTime(0.0001, now + dur);
        o.stop(now + dur + 0.02);
      });
    }

    _ambient(){
      // create a very subtle drone using oscillator + gain
      if(this.sounds.bg) return; // already playing
      const ctx = this.ensureCtx();
      const o = ctx.createOscillator();
      const g = ctx.createGain();
      o.type='sine'; o.frequency.value = 55;
      g.gain.value = 0.0005; // very subtle
      o.connect(g); g.connect(this.bgGain);
      o.start();
      this.sounds.bg = o;
    }

    _clockTick(){
      // emulate ticking loop (short beep) until stopped
      if(this.clockPlaying) return;
      this.clockPlaying = true;
      const tick = ()=>{
        if(!this.clockPlaying) return;
        this._tone(1200,0.06,0.06);
        setTimeout(tick, 900);
      };
      tick();
    }

    resumeAudioContext(){
      this.ensureCtx();
      if(this.ctx && this.ctx.state === 'suspended'){
        this.ctx.resume();
      }
    }
  }

  const audio = new AudioMgr();

  // ---- Game logic (kept similar to your original, but polished) ----
  const questions = [
    {q:"Which is the largest planet in our Solar System?", c:["Earth","Mars","Jupiter","Venus"], a:2},
    {q:"Who wrote the epic 'Ramayana'?", c:["Valmiki","Tulsidas","Ved Vyas","Kalidas"], a:0},
    {q:"What is the capital of Australia?", c:["Sydney","Canberra","Melbourne","Perth"], a:1},
    {q:"Which element has the chemical symbol 'O'?", c:["Gold","Oxygen","Silver","Iron"], a:1},
    {q:"What is the freezing point of water in Celsius?", c:["100","0","32","-1"], a:1},
    {q:"Which is the longest river in the world?", c:["Amazon","Nile","Yangtze","Mississippi"], a:1},
    {q:"Who was the first President of India?", c:["Dr. Rajendra Prasad","Jawaharlal Nehru","Sardar Patel","Dr. Radhakrishnan"], a:0},
    {q:"Which is the smallest continent in the world?", c:["Europe","Australia","South America","Antarctica"], a:1},
    {q:"What is the chemical formula of water?", c:["H2O","CO2","O2","N2"], a:0},
    {q:"Who discovered gravity?", c:["Albert Einstein","Isaac Newton","Galileo Galilei","Niels Bohr"], a:1}
  ];

  // state
  let idx=0, score=0, used5050=false, usedSwitch=false;
  let disabledSet=new Set(), locked=false, selectedIndex=null;
  const secondsPerQ = 30;
  let timeLeft = secondsPerQ, timerInterval=null;

  // DOM refs
  const startOverlay = document.getElementById('startOverlay');
  const startBtn = document.getElementById('startBtn');
  const mainApp = document.querySelector('.wrap');
  const qText = document.getElementById('question-text');
  const optionsEl = document.getElementById('options');
  const qIndexEl = document.getElementById('qIndex');
  const qTotalEl = document.getElementById('qTotal');
  const scoreEl = document.getElementById('score');
  const used5050El = document.getElementById('used5050');
  const usedSwitchEl = document.getElementById('usedSwitch');
  const ladderEl = document.getElementById('ladder');
  const btn5050 = document.getElementById('btn5050');
  const btnSwitch = document.getElementById('btnSwitch');
  const btnAudience = document.getElementById('btnAudience');
  const btnLock = document.getElementById('btnLock');
  const btnNext = document.getElementById('btnNext');
  const timeValueEl = document.getElementById('timeValue');

  // ladder data
  const ladder = ["\u20B9100","\u20B9250","\u20B9400","\u20B91,000","\u20B92,500","\u20B95,000","\u20B910,000","\u20B920,000","\u20B940,000","\u20B980,000"];

  function renderLadder(){
    ladderEl.innerHTML='';
    for(let i=ladder.length-1;i>=0;i--){
      const el = document.createElement('div');
      el.innerHTML = `<strong>#${i+1}</strong><span>${ladder[i]||''}</span>`;
      if(i===idx) el.classList.add('active');
      ladderEl.appendChild(el);
    }
  }

  function showGameOver(){
    optionsEl.innerHTML = `<div style="text-align:center;padding:30px"><h2>Game Over</h2><p>Your Score: <strong>${score}</strong> / ${questions.length}</p></div>`;
    qText.textContent = 'Thanks for playing!';
    qIndexEl.textContent = questions.length;
    scoreEl.textContent = score;
    stopTimer();
    audio.stop('clock'); audio.stop('question'); audio.stop('bg');
    btn5050.disabled = btnSwitch.disabled = btnAudience.disabled = btnLock.disabled = btnNext.disabled = true;
  }

  function stopTimer(){ if(timerInterval){ clearInterval(timerInterval); timerInterval=null; } }
  function startTimer(){
    stopTimer();
    timeLeft = secondsPerQ; timeValueEl.textContent = timeLeft;
    audio.play('clock', {loop:true});
    audio.play('bg', {loop:true, volume:0.35});
    timerInterval = setInterval(()=>{
      timeLeft--; timeValueEl.textContent = timeLeft;
      if(timeLeft <= 0){ stopTimer(); onTimeUp(); }
    },1000);
  }
  function onTimeUp(){
    locked=true; audio.stop('clock'); audio.play('wrong'); revealAnswer(-1);
  }

  function loadQuestion(){
    if(idx < 0 || idx >= questions.length){ showGameOver(); return; }
    locked=false; selectedIndex=null;
    optionsEl.innerHTML='';
    const q = questions[idx];
    qText.textContent = q.q;
    qIndexEl.textContent = idx+1;
    qTotalEl.textContent = questions.length;
    scoreEl.textContent = score;
    used5050El.textContent = used5050 ? 'Yes' : 'No';
    usedSwitchEl.textContent = usedSwitch ? 'Yes' : 'No';
    renderLadder();

    q.c.forEach((txt,i)=>{
      const btn = document.createElement('button');
      btn.className='option';
      btn.dataset.i = i;
      btn.innerHTML = `<strong>${String.fromCharCode(65+i)}.</strong><span style="margin-left:8px">${txt}</span>`;
      if(disabledSet.has(i)){ btn.classList.add('disabled'); btn.disabled = true; }
      btn.addEventListener('click', ()=>{
        if(locked) return;
        document.querySelectorAll('.option').forEach(x=>x.classList.remove('selected'));
        btn.classList.add('selected'); selectedIndex = i;
        audio.play('question');
      });
      optionsEl.appendChild(btn);
    });

    // play audio and start timer
    audio.play('question');
    audio.play('bg', {loop:true, volume:0.35});
    startTimer();
  }

  function revealAnswer(sel){
    if(idx < 0 || idx >= questions.length) return;
    const q=questions[idx];
    const btns = Array.from(document.querySelectorAll('.option'));
    btns.forEach(b=>b.classList.add('disabled'));
    const correctIdx = q.a;
    if(sel === correctIdx){
      const b = btns.find(b=>Number(b.dataset.i) === correctIdx);
      if(b) b.classList.add('correct');
      audio.play('correct');
      score++;
    } else {
      const selectedBtn = btns.find(b=>Number(b.dataset.i) === sel);
      const correctBtn = btns.find(b=>Number(b.dataset.i) === correctIdx);
      if(selectedBtn) selectedBtn.classList.add('wrong');
      if(correctBtn) correctBtn.classList.add('correct');
      audio.play('wrong');
    }
    scoreEl.textContent = score;
  }

  // lifelines
  function lifeline5050(){
    if(used5050) { alert('50-50 already used'); return; }
    const q = questions[idx];
    const wrongs = [0,1,2,3].filter(i=>i!==q.a);
    wrongs.sort(()=>Math.random()-0.5);
    const hide = wrongs.slice(0,2);
    hide.forEach(i=>disabledSet.add(i));
    used5050=true; btn5050.disabled=true; loadQuestion();
  }

  function lifelineSwitch(){
    if(usedSwitch){ alert('Switch already used'); return; }
    const available = questions.filter((_,i)=>i !== idx);
    if(available.length === 0){ alert('No questions to switch with'); return; }
    const pickIdx = Math.floor(Math.random()*available.length);
    const other = available[pickIdx];
    const otherRealIndex = questions.findIndex(q=>q.q === other.q && q !== questions[idx]);
    if(otherRealIndex >= 0){
      const tmp = questions[idx];
      questions[idx] = questions[otherRealIndex];
      questions[otherRealIndex] = tmp;
      usedSwitch = true;
      btnSwitch.disabled = true;
      loadQuestion();
    } else {
      questions.push(questions.shift()); usedSwitch=true; btnSwitch.disabled=true; loadQuestion();
    }
  }

  function lifelineAudience(){
    const q = questions[idx];
    alert(`Audience poll suggests option ${String.fromCharCode(65+q.a)} is most popular.`);
    btnAudience.disabled = true;
  }

  // UI handlers
  btn5050.addEventListener('click', lifeline5050);
  btnSwitch.addEventListener('click', lifelineSwitch);
  btnAudience.addEventListener('click', lifelineAudience);

  btnLock.addEventListener('click', ()=>{
    if(locked) return;
    if(selectedIndex === null){ alert('Please select an option first'); return; }
    locked = true;
    stopTimer();
    audio.stop('clock'); audio.play('lock');
    // mark selected
    document.querySelectorAll('.option').forEach(x=>{
      x.classList.remove('selected');
      if(Number(x.dataset.i) === selectedIndex){
        x.style.backgroundColor = 'var(--panel)';
        x.style.borderColor = 'var(--gold)';
      }
    });
    setTimeout(()=>{
      audio.play('confirm');
      setTimeout(()=> revealAnswer(selectedIndex), 700);
    }, 600);
  });

  btnNext.addEventListener('click', ()=>{
    // next question
    idx++;
    disabledSet.clear(); // fresh unless 50-50 used earlier in game (optional)
    if(idx >= questions.length){ showGameOver(); return; }
    loadQuestion();
  });

  // START flow: ensure AudioContext resumes and audio works
  startBtn.addEventListener('click', ()=>{
    // resume audio context (required by many browsers)
    audio.resumeAudioContext();
    // hide overlay and show main UI
    startOverlay.style.display = 'none';
    // kick start sound and background
    audio.play('start');
    setTimeout(()=>{
      audio.play('bg', {loop:true, volume:0.35});
      loadQuestion();
    }, 600);
  });

  // initial UI numbers
  qTotalEl && (qTotalEl.textContent = questions.length);
  qIndexEl && (qIndexEl.textContent = 0);
  scoreEl && (scoreEl.textContent = 0);
  renderLadder();

  // Helpful hotkeys (optional)
  window.addEventListener('keydown', (e)=>{
    if(e.key === '1') document.querySelectorAll('.option')[0] && document.querySelectorAll('.option')[0].click();
    if(e.key === '2') document.querySelectorAll('.option')[1] && document.querySelectorAll('.option')[1].click();
    if(e.key === '3') document.querySelectorAll('.option')[2] && document.querySelectorAll('.option')[2].click();
    if(e.key === '4') document.querySelectorAll('.option')[3] && document.querySelectorAll('.option')[3].click();
    if(e.key.toLowerCase() === 'l') btnLock.click();
    if(e.key.toLowerCase() === 'n') btnNext.click();
  });

})();
</script>
</body>
</html>
